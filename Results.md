
1. Сбор и предобработка данных.

| № Этапа    | Название               | Количество соединений |
| ------------- |:------------------:| -----:|
| 1    | Скачивание всех активностей в IC50   | 13200|
| 2     | Исключение активностей по отношению к мутантным формам hERG |	13181 |
| 3  | Исключение дубликатов (по ChEMBL_ID) и удаление строк с путыми значениями в колонках units, standard_type, value  | 8253 |
| 4  | Приведение всех значений IC50 к одним единицам измерения (nM)  | 8253 |
| 5  | Проставление меток класса (граница IC50 = 10 мкМ)| 8253 |
| 6  | Исключение соединений с пропущенными или неопределенными значениями в realtion  | 8158 |
| 7  | Расчет pIC50  | 8158 |
| 8  |  	Стандартизация RDkit | 8158 |
| 9  |  	Исключение солевых форм |	7879 |

2. Анализ датасета.
  - Статистический анализ по целевому значению переменной (IC50).
 ![Image alt](https://github.com/ElinaSmall/hERg_model/raw/main/images/df_stat.JPG)    ![Image alt](https://github.com/ElinaSmall/hERg_model/raw/main/images/train_stat.JPG)
 ![Image alt](https://github.com/ElinaSmall/hERg_model/raw/main/images/test_stat.JPG)
  - Анализ на схожесть (similarity-анализ) обучающей и тестовой выборок. Similarity-анализ был для двух выорок реализован следующим образом:
  1. Расчет Tanimoto_matrix (где в узлах матрицы расположены значения Tanimoto index между каждым соединением из выборки №1 с каждым соединением из выборки №2).
  2. Подсчет количества сходных соединений в различных диапазонах Tanimoto_index (0-0.33, 0.33-0.66, 0.66-1.00).
  3. Построение графика распределения по парным значениям Tanimoto_index.
  Для similarity-анализа двух выборок обучающей и тестовой (train и test):
  Counter({'Tanimoto_index = 0.66 - 1.00': 1056, 'Tanimoto_index = 0.33 - 0.66': 419, 'Tanimoto_index = 0.00 - 0.33': 101})
  1056 соединений из обучающей выборки явлюятся хорошо похожими на таковые соединения из тестовой выборки, и лишь 101 соединения совсем не похожи друг на друга. Следовательно, построенная модель будет верно предсказывать тестовую выборку, деление на обучающие и тестовые наборы прошло успешно. 
  ![Image alt](https://github.com/ElinaSmall/hERg_model/raw/main/images/test-train-sim-matrix.JPG)
 


